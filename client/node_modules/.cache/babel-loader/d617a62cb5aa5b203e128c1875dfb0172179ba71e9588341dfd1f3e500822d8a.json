{"ast":null,"code":"var _jsxFileName = \"/home/slow/ticket-sys/client/src/components/TicketsGenerated.jsx\",\n  _s = $RefreshSig$();\nimport { useLocation } from \"react-router-dom\";\nimport { useRef, useState } from \"react\";\nimport axios from \"axios\";\nimport './ticketgenerated.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TicketGenerated = () => {\n  _s();\n  const location = useLocation();\n  const {\n    firstName,\n    reservedTicketNumbers,\n    phoneNumber\n  } = location.state || {};\n\n  // Canvas ref for image generation\n  const canvasRef = useRef(null);\n\n  // State for SMS status and loading\n  const [smsStatus, setSmsStatus] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const handleDownload = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n\n    // Set up canvas size\n    canvas.width = 800;\n    canvas.height = 600;\n\n    // Set background color and text styling\n    ctx.fillStyle = \"#f4f4f9\";\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.font = \"24px Arial\";\n    ctx.fillStyle = \"#34495e\";\n\n    // Title\n    ctx.fillText(`Reserved Tickets for ${firstName}`, 20, 40);\n\n    // List tickets\n    let yPosition = 80;\n    reservedTicketNumbers.forEach(ticket => {\n      ctx.fillText(`Ticket #${ticket}`, 20, yPosition);\n      yPosition += 40;\n    });\n\n    // Convert canvas to PNG and download\n    const imageUrl = canvas.toDataURL(\"image/png\");\n    const link = document.createElement(\"a\");\n    link.href = imageUrl;\n    link.download = \"reserved-tickets.png\";\n    link.click();\n  };\n  const handleSendSms = async () => {\n    if (!phoneNumber) {\n      setSmsStatus(\"Phone number is missing. Cannot send SMS.\");\n      return;\n    }\n    setLoading(true);\n    setSmsStatus(\"\");\n    try {\n      const response = await axios.post(\"https://ticket-sys-server.vercel.app/api/tickets/send-sms\", {\n        phoneNumber,\n        message: `Hello ${firstName}, your reserved tickets: ${reservedTicketNumbers.join(\", \")}`\n      });\n      if (response.data.success) {\n        setSmsStatus(\"SMS sent successfully!\");\n      } else {\n        setSmsStatus(\"Failed to send SMS. Please try again.\");\n      }\n    } catch (error) {\n      console.error(\"Error sending SMS:\", error);\n      setSmsStatus(\"An error occurred while sending the SMS.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ticket-generated-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ticket-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Tickets Reserved\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"thank-you-message\",\n        children: [\"Thank you for reserving, \", firstName, \"!\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ticket-list\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"reserved-tickets-header\",\n        children: \"Your Reserved Tickets:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"ticket-numbers\",\n        children: reservedTicketNumbers.map((ticket, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"ticket-item\",\n          children: [\"Ticket #\", ticket]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"button-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"download-button\",\n        onClick: handleDownload,\n        children: \"Download Tickets as PNG\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"sms-button\",\n        onClick: handleSendSms,\n        disabled: loading,\n        children: loading ? \"Sending SMS...\" : \"Send Tickets via SMS\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), smsStatus && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"sms-status\",\n      children: smsStatus\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        display: \"none\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(TicketGenerated, \"YWwOxG4AGz3cBVEQlIc+v8jYTLo=\", false, function () {\n  return [useLocation];\n});\n_c = TicketGenerated;\nexport default TicketGenerated;\nvar _c;\n$RefreshReg$(_c, \"TicketGenerated\");","map":{"version":3,"names":["useLocation","useRef","useState","axios","jsxDEV","_jsxDEV","TicketGenerated","_s","location","firstName","reservedTicketNumbers","phoneNumber","state","canvasRef","smsStatus","setSmsStatus","loading","setLoading","handleDownload","canvas","current","ctx","getContext","width","height","fillStyle","fillRect","font","fillText","yPosition","forEach","ticket","imageUrl","toDataURL","link","document","createElement","href","download","click","handleSendSms","response","post","message","join","data","success","error","console","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","index","onClick","disabled","ref","style","display","_c","$RefreshReg$"],"sources":["/home/slow/ticket-sys/client/src/components/TicketsGenerated.jsx"],"sourcesContent":["import { useLocation } from \"react-router-dom\";\nimport { useRef, useState } from \"react\";\nimport axios from \"axios\";\nimport './ticketgenerated.css';\n\nconst TicketGenerated = () => {\n  const location = useLocation();\n  const { firstName, reservedTicketNumbers, phoneNumber } = location.state || {};\n\n  // Canvas ref for image generation\n  const canvasRef = useRef(null);\n\n  // State for SMS status and loading\n  const [smsStatus, setSmsStatus] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  const handleDownload = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n\n    // Set up canvas size\n    canvas.width = 800;\n    canvas.height = 600;\n\n    // Set background color and text styling\n    ctx.fillStyle = \"#f4f4f9\";\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.font = \"24px Arial\";\n    ctx.fillStyle = \"#34495e\";\n\n    // Title\n    ctx.fillText(`Reserved Tickets for ${firstName}`, 20, 40);\n\n    // List tickets\n    let yPosition = 80;\n    reservedTicketNumbers.forEach(ticket => {\n      ctx.fillText(`Ticket #${ticket}`, 20, yPosition);\n      yPosition += 40;\n    });\n\n    // Convert canvas to PNG and download\n    const imageUrl = canvas.toDataURL(\"image/png\");\n    const link = document.createElement(\"a\");\n    link.href = imageUrl;\n    link.download = \"reserved-tickets.png\";\n    link.click();\n  };\n\n  const handleSendSms = async () => {\n    if (!phoneNumber) {\n      setSmsStatus(\"Phone number is missing. Cannot send SMS.\");\n      return;\n    }\n\n    setLoading(true);\n    setSmsStatus(\"\");\n\n    try {\n      const response = await axios.post(\"https://ticket-sys-server.vercel.app/api/tickets/send-sms\", {\n        phoneNumber,\n        message: `Hello ${firstName}, your reserved tickets: ${reservedTicketNumbers.join(\", \")}`\n      });\n\n      if (response.data.success) {\n        setSmsStatus(\"SMS sent successfully!\");\n      } else {\n        setSmsStatus(\"Failed to send SMS. Please try again.\");\n      }\n    } catch (error) {\n      console.error(\"Error sending SMS:\", error);\n      setSmsStatus(\"An error occurred while sending the SMS.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"ticket-generated-container\">\n      <div className=\"ticket-header\">\n        <h1>Tickets Reserved</h1>\n        <p className=\"thank-you-message\">Thank you for reserving, {firstName}!</p>\n      </div>\n      <div className=\"ticket-list\">\n        <p className=\"reserved-tickets-header\">Your Reserved Tickets:</p>\n        <ul className=\"ticket-numbers\">\n          {reservedTicketNumbers.map((ticket, index) => (\n            <li key={index} className=\"ticket-item\">Ticket #{ticket}</li>\n          ))}\n        </ul>\n      </div>\n\n      <div className=\"button-group\">\n        <button className=\"download-button\" onClick={handleDownload}>Download Tickets as PNG</button>\n        <button className=\"sms-button\" onClick={handleSendSms} disabled={loading}>\n          {loading ? \"Sending SMS...\" : \"Send Tickets via SMS\"}\n        </button>\n      </div>\n\n      {smsStatus && <p className=\"sms-status\">{smsStatus}</p>}\n\n      {/* Hidden canvas element */}\n      <canvas ref={canvasRef} style={{ display: \"none\" }} />\n    </div>\n  );\n};\n\nexport default TicketGenerated;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}